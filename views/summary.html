<% layout('layout') -%>

<!-- Page content -->
        <div id="content" class="col-md-12">

          <!-- page header -->
          <div class="pageheader">
            

            <h2><i class="fa fa-tachometer"></i> Group Summary
            <span><%=group.name%></%></span></h2>
            

            <div class="breadcrumbs">
              <ol class="breadcrumb">
                <li>You are here</li>
                <li><a href="/">Pay Together</a></li>
                <li class="active">Group Summary</li>
              </ol>
            </div>


          </div>
          <!-- /page header -->

          <!-- content main container -->
          <div class="main">



            <!-- cards 
            <%- partial('./_grouplist') %>
             /cards -->
            
              <%
                 var isOwner = group.creator == current_user.id;
                 %>
            <div class="row">
              <div class="col-md-6">
                <div class="card-container col-sm-12">
                <div class="card card-<%=group.card_color%> hover">
                  <div class="front"> 

                    <div class="media">        
                      <span class="pull-left">
                        <i class="fa <%=group.card_icon%> media-object"></i>
                      </span>

                      <div class="media-body">
                        <%=group.name%> 
                            <small style='float:right'>
                                <i class="fa fa-clock-o"></i><%=group.create_at.format('mm/dd/yyyy')%>
                                &nbsp;
                                <i class="fa fa-user"></i><%=group.member_amount%>
                                <% if(isOwner){ %>
                                &nbsp;
                                <i class="fa fa-wrench" style="color:white"></i>
                                <% } %>
                            </small><br>
                            <small style='float:right'><i class='fa fa-calendar-o'></i>$<%=group.expected_total.toFixed(2)%></small>
                        <h2 class="media-heading animate-number" data-value="<%=group.pay_amount%>" data-animation-duration="1500">0</h2>
                               
                        
                                </div>    
                    </div> 

                    <div class="progress-list">
                      <div class="details">
                        <div class="title">Used %</div>
                      </div>
                      <div class="status pull-right bg-transparent-black-1">
                        <span class="animate-number" data-value="<%=group.pay_percent%>" data-animation-duration="1500">0</span>%
                      </div>
                      <div class="clearfix"></div>
                      <div class="progress progress-little progress-transparent-black">
                        <div class="progress-bar animate-progress-bar" data-percentage="<%=group.pay_percent%>%"></div>
                      </div>
                    </div>

                  </div>
                
                </div>
              </div>
                                
                                
                <div class="card-container col-sm-12">
                <div class="card card-<%=group.card_color%> flip">
                  <div class="front">   


                  </div>
                
                  <div class="back <%=isOwner?'three-item':'two-item'%>">
                    <a href="/pay/add/<%=group.id%>">
                      <i class="fa fa-tags fa-4x"></i>
                      <span>Add A Pay</span>
                    </a>
                    <a href="/summary/<%=group.id%>">
                      <i class="fa fa-bar-chart-o fa-4x"></i>
                      <span>Summary</span>
                    </a>
                    <% if(isOwner){ %>
                    <a href="/editgroup/<%=group.id%>">
                      <i class="fa fa-pencil-square-o fa-4x"></i>
                      <span>Edit</span>
                    </a>
                    <% } %>
                  </div>
                </div>
              </div>
                                
                                
                </div>
              
                <div class="col-md-6">
                    <section class="tile color transparent-black textured">
                      <!-- tile header -->
                      
                      <!-- /tile header -->

                      <!-- tile body -->
                      <div class="tile-body">
                          <p><strong>Current</strong></p>
                          <ul class="solution">
                              
                              <% for(var i = 0;i<solution.diff.length;i++){
                                var diff = solution.diff[i];
                              %>
                              <li>
                                <a href="#">
                                    <% if(diff.value>0){%>
                                        <div class="notification notification-danger">
                                          <img src="/assets/avatars/<%=diff.avatar%>" class="w35">
                                          <label><%=diff.name%></label>
                                          &nbsp;need to pay
                                          <i class="fa fa-chevron-right"></i>
                                          <i class="fa fa-chevron-right"></i>

                                          <span class="amount"><i class="fa fa-chevron-right"></i>
                                          <i class="fa fa-chevron-right"></i>$ <%=diff.value.toFixed(2)%></span>
                                        </div>
                                    <%}else if(diff.value<0){%>
                                        
                                        <div class="notification notification-success">
                                          <img src="/assets/avatars/<%=diff.avatar%>" class="w35">
                                          <label><%=diff.name%></label>
                                          &nbsp;need to be paid
                                          <i class="fa fa-chevron-left"></i>
                                          <i class="fa fa-chevron-left"></i>

                                          <span class="amount"><i class="fa fa-chevron-left"></i>
                                          <i class="fa fa-chevron-left"></i>$ <%=Math.abs(diff.value).toFixed(2)%></span>
                                        </div>
                                        
                                    <%}else{%>
                                        
                                        <div class="notification notification-info">
                                          <img src="/assets/avatars/<%=diff.avatar%>" class="w35">
                                          <label><%=diff.name%></label>
                                          &nbsp;is already balanced&nbsp;
                                        </div>
                                    <%}%>
                                 
                                </a>
                              </li>
                              <% } %>
                                  </ul>
                          
                          <p><strong>Solution</strong></p>
                          <ul class="solution">
                              
                                  
                            <% for(var i = 0;i<solution.todo.length;i++){
                                var todo = solution.todo[i];
                              %>
                              <li>
                                <a href="#">
                                  <div class="notification notification-blue">
                                      <img src="/assets/avatars/<%=todo.from.avatar%>" class="w35">
                                      <label><%=todo.from.name%></label>
                                      &nbsp;&nbsp;
                                      <i class="fa fa-chevron-right"></i>
                                      <i class="fa fa-chevron-right"></i>
                                      &nbsp;&nbsp;
                                      <img src="/assets/avatars/<%=todo.to.avatar%>" class="w35">
                                      <label><%=todo.to.name%></label>

                                      <span class="amount">$ <%=todo.amount.toFixed(2)%></span>
                                    </div>
                                </a>
                              </li>
                              <% } %>
                            </ul>
                      </div>
                      <!-- /tile body -->

                      


                    </section>
                </div>
              </div>



            <!-- row -->
            <div class="row">

              <!-- col 6 -->
              <div class="col-md-12">

                
                <!-- tile -->
                <section class="tile transparent recent-activity">




                  <!-- tile header -->
                  <div class="tile-header transparent">               
                    <h1><strong>Recent</strong> Activity</h1>
                  </div>
                  <!-- /tile header -->


                  
                  <!-- tile widget -->
                  <div class="tile-widget color transparent-black rounded-top-corners nopadding">
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs tabdrop">
                      <li class="active"><a href="#total-tab" data-toggle="tab">All</a></li>
                      <li><a href="#pay-tab" data-toggle="tab">Pay</a></li>
                      <li><a href="#transfer-tab" data-toggle="tab">Transfer</a></li>
                    </ul>
                    <!-- / Nav tabs -->
                  </div>
                  <!-- /tile widget -->




                  <!-- tile body -->
                  <div class="tile-body tab-content nopadding rounded-bottom-corners">
                    <!-- Tab panes -->
                    
                    <ul id="total-tab" class="tab-pane fade in active">
                    <% for(var i=0;i<pays.length;i++){
                        var pay = pays[i]; %>
                        <%- partial('./_payitem',{pay:pay}) %>
                    <% } %>
                    </ul>

                    <ul id="pay-tab" class="tab-pane fade">
                    <% for(var i=0;i<pays.length;i++){
                        var pay = pays[i]; 
                        if(!pay.isPay)continue;
                        %>
                        <%- partial('./_payitem',{pay:pay}) %>
                    <% } %>
                    </ul>

                    <ul id="transfer-tab" class="tab-pane fade">
                    <% for(var i=0;i<pays.length;i++){
                        var pay = pays[i]; 
                        if(pay.isPay)continue;
                        %>
                        <%- partial('./_payitem',{pay:pay}) %>
                    <% } %>
                    </ul>

                   
                    <!-- / Tab panes -->
                  </div>
                  <!-- /tile body -->
                
                </section>
                <!-- /tile -->
              </div>
              <!-- /col 6 -->
            </div>
            <!-- /row -->  
          </div>
          <!-- /content container -->
        </div>
        <!-- Page content end -->



        <script>
    $(function(){

      // Initialize card flip

      
        $(".tooltip-img").tooltip();

      
    })
      
    </script>